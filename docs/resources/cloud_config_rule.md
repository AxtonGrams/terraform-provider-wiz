---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "wiz_cloud_config_rule Resource - terraform-provider-wiz"
subcategory: ""
description: |-
  A Cloud Configuration Rule is a configuration check that applies to a specific cloud resource type—if a resource does not pass a Rule, a Configuration Finding is generated and associated with the resource on the Security Graph.
---

# wiz_cloud_config_rule (Resource)

A Cloud Configuration Rule is a configuration check that applies to a specific cloud resource type—if a resource does not pass a Rule, a Configuration Finding is generated and associated with the resource on the Security Graph.

## Example Usage

```terraform
resource "wiz_cloud_config_rule" "test" {
  name        = "terraform-test-iac"
  description = "test description"
  target_native_types = [
    "account",
  ]
  security_sub_categories = [
    "wsct-id-7",
    "wsct-id-3759",
  ]
  scope_account_ids = [
    "87d3d654-41ba-53d2-aeba-8399be9f62d7",
    #"e295ffc1-636a-5f8f-959a-4bf9fdba9727",
  ]
  function_as_control      = false
  remediation_instructions = "fix it"
  enabled                  = false
  severity                 = "HIGH"
  opa_policy               = <<EOT
package wiz

default result = "pass"
EOT
  iac_matchers {
    type      = "CLOUD_FORMATION"
    rego_code = <<EOT
package wiz

import data.generic.cloudformation as cloudFormationLib

import data.generic.common as common_lib

WizPolicy[result] {
        resource := input.document[i].Resources[name]
        resource.Type == "AWS::Config::ConfigRule"
        not hasAccessKeyRotationRule(resource)

        result := {
                "documentId": input.document[i].id,
                "searchKey": sprintf("Resources.%s", [name]),
                "issueType": "MissingAttribute",
                "keyExpectedValue": sprintf("Resources.%s has a ConfigRule defining rotation period on AccessKeys.", [name]),
                "keyActualValue": sprintf("Resources.%s doesn't have a ConfigRule defining rotation period on AccessKeys.", [name]),
                "resourceTags": cloudFormationLib.getCFTags(resource),
        }
}

hasAccessKeyRotationRule(configRule) {
        configRule.Properties.Source.SourceIdentifier == "ACCESS_KEYS_ROTATED"
} else = false {
        true
}
EOT
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `description` (String) Detailed description for this rule. There is a defect in the API that makes this required; the description field cannot be nullified after one is defined, so we make it required.
- `name` (String) Name of this rule, as appeared in the UI in the portal.
- `remediation_instructions` (String) Steps to mitigate the issue that match this rule. If possible, include sample commands to execute in your cloud provider's console. Markdown formatting is supported.
- `target_native_types` (Set of String) The identifier types of the resources targeted by this rule, as seen on the cloud provider service. e.g. 'ec2'

### Optional

- `enabled` (Boolean) Enable/disable this rule.
    - Defaults to `true`.
- `function_as_control` (Boolean) Make this rule function as a Control that creates Issues for new findings. By default only findings are created. If enabled=false, an error will be returned if this is set to true.
    - Defaults to `false`.
- `iac_matchers` (Block Set) OPA rego policies that this rule runs (Cloud / IaC rules). (see [below for nested schema](#nestedblock--iac_matchers))
- `opa_policy` (String) OPA rego policy that defines this rule.
- `scope_account_ids` (Set of String) Set the rule scope of cloud account IDs. Select only subscriptions matching to the rule cloud provider. To change scope to 'all relevant resources' set to empty array. This must be the Wiz internal identifier for the account(uuid format).
- `severity` (String) Severity that will be set for findings of this rule.
    - Allowed values: 
        - INFORMATIONAL
        - LOW
        - MEDIUM
        - HIGH
        - CRITICAL

    - Defaults to `MEDIUM`.

### Read-Only

- `id` (String) Wiz internal identifier.
- `security_sub_categories` (Set of String) Associate this rule with security sub-categories to easily monitor your compliance. New Configuration Findings created by this rule will be tagged with the selected sub-categories. There is a defect in the API that makes this required; the security_sub_categories field cannot be nullified after one is defined, so we make it required.

<a id="nestedblock--iac_matchers"></a>
### Nested Schema for `iac_matchers`

Required:

- `rego_code` (String) Write code in the Rego query language. This code will be evaluated against the JSON representation of each resource of the selected Native Type to determine if it passes or fails the rule.
- `type` (String) The type of resource that will be evaluated by the Rego Code.
    - Allowed values: 
        - TERRAFORM
        - CLOUD_FORMATION
        - KUBERNETES
        - AZURE_RESOURCE_MANAGER
        - DOCKER_FILE
        - ADMISSION_CONTROLLER
